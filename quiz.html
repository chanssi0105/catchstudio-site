<!doctype html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>ëª¸ìœ¼ë¡œ ë§í•´ìš” ì œì‹œì–´ ê²Œì„</title>
  <meta name="viewport" content="height=device-height, width=device-width, initial-scale=1.0, maximum-scale=1.0">

  <!-- ê¸°ë³¸ íŒŒë¹„ì½˜ -->
  <link rel="icon" type="image/png" sizes="32x32" href="/assets/images/favicon-quiz.png">
  <link rel="icon" type="image/png" sizes="192x192" href="/assets/images/favicon-quiz.png">

  <!-- ì• í”Œ í™ˆ í™”ë©´ ì¶”ê°€ ì‹œ -->
  <link rel="apple-touch-icon" href="/assets/images/favicon-quiz.png">

  <style>
    * { box-sizing: border-box; }
    html, body {
      margin: 0;
      padding: 0;
      overflow: hidden;
      height: 100%;
    }

    body {
      margin: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: #f3f4f6;
      color: #222;
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: stretch;
      line-height:1.5;

      overscroll-behavior: none;
      touch-action: none;
    }

    .app {
      width: 100%;
      height:100vh;
      background: #ffffff;
      border-radius: 16px;
      padding: 2.5%;
      display: flex;
      flex-direction: column;
    }

    /* ---- í—¤ë” (ì œì‹œì–´ í™”ë©´ì—ì„œë§Œ ë³´ì„) ---- */
    .app-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 8px;
      margin-bottom: 4px;
    }
    h1 {
      width: 100%;
      font-size: 2rem;
      margin: 0;
      text-align: center;
    }
    .subtitle {
      font-size: 1rem;
      text-align: center;
      color: #777;
      margin-bottom: 30px;
    }
    .icon-button {
      position:absolute;
      z-index:1;
      top:30px;
      right:30px;
      border: none;
      background: transparent;
      cursor: pointer;
      font-size: 1.3rem;
      padding: 4px;
    }

    /* ---- ê³µí†µ í™”ë©´ ---- */
    .screen { display: none; flex: 1; }
    .screen.active { display: flex; flex-direction: column;}
    #screen-ready, #screen-result{justify-content: center; height:100%;}
    

    /* ---- ì œì‹œì–´ ì„ íƒ ---- */
    .category-list {
      margin-top: 8px;
      display: grid;
      grid-template-columns: repeat(5, 1fr); /* 5ì—´ */
      gap: 20px;
    }
    .category-item {
      width: 100%;
      min-height:250px;
      padding: 25px;
      border-radius: 12px;
      border: 1px solid #e5e7eb;
      background: #f9fafb;
      cursor: pointer;
      display: flex;
      justify-content: space-between;
      align-items: center;
      flex-direction: column;
      font-size: 2rem;
      font-weight:700;
      text-align:center;
    }
    .category-item span.sub {
      font-size: 1rem;
      color: #9ca3af;
    }
    .category-item:hover {
      background: #eff6ff;
      border-color: #3b82f6;
    }

    .big-word {
      font-size: 4rem;
      font-weight: 600;
      text-align: center;
      margin: 32px 12px 20px;
      word-break: keep-all;
    }
    .info-text {
      font-size: 1.2rem;
      color: #6b7280;
      text-align: center;
      margin-bottom: 20px;
      line-height: 1.5;
    }

    .btn-row {
      display: flex;
      gap: 8px;
      justify-content: center;
      margin-top: 8px;
    }
    button {
      border: none;
      border-radius: 999px;
      padding: 14px 20px;
      font-size: 1.2rem;
      cursor: pointer;
      font-weight: 500;
    }
    .btn-primary { background: #3b82f6; color: white; }
    .btn-secondary { background: #e5e7eb; color: #111827; }
    .btn-ghost { background: transparent; color: #6b7280; }

    /* ---- ê²Œì„ í™”ë©´ ---- */
    #screen-game { height: 100%; }
    .game-inner {
      flex: 1;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      min-height: 0;
    }
    .game-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 16px;
      font-size: 0.95rem;
    }
    .badge {
      padding: 10px 16px;
      border-radius: 999px;
      font-size: 1.2rem;
      background: #f3f4f6;
    }
    .badge.timer {
      background: #fef3c7;
      color: #b45309;
    }
    .badge.score {
      background: #dbeafe;
      color: #1d4ed8;
    }
    .game-word-wrap {
      flex: 1;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 8px;
    }
    #game-word {
      font-size: clamp(7rem, 8vw, 13rem);
      font-weight: 700;
      text-align: center;
      word-break: keep-all;
      line-height: 1.1;
    }

    .ox-row {
      display: flex;
      justify-content: center;
      gap: 30px;
      margin-top: 16px;
    }
    .btn-o, .btn-x {
      flex: 1;
      height:100px;
      padding: 20px;
      font-size: 2rem;
      font-weight:700;
      color: white;
    }
    .btn-o { background: #22c55e; }
    .btn-x { background: #ef4444; }

    .btn-pass {
      width: 100%;
      margin-top: 30px;
      background: #e5e7eb;
      color: #111827;
      padding: 20px;
      font-size: 2rem;
      font-weight:700;
    }
    .btn-pass:disabled {
      background: #f3f4f6;
      color: #9ca3af;
      cursor: default;
    }

    .result-number {
      font-size: clamp(7rem, 8vw, 20rem);
      font-weight: 700;
      text-align: center;
      margin: 16px 0 8px;
      line-height:1;
    }
    .result-label {
      font-size: 1.2rem;
      text-align: center;
      color: #4b5563;
    }

    /* ---- ì„¤ì • ëª¨ë‹¬ ---- */
    .modal-backdrop {
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, 0.4);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 50;
    }
    .modal {
      background: #ffffff;
      border-radius: 16px;
      padding: 16px 18px 14px;
      width: 100%;
      max-width: 360px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.18);
    }
    .modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 10px;
    }
    .modal-title {
      font-size: 1rem;
      font-weight: 600;
    }
    .modal-close {
      border: none;
      background: transparent;
      font-size: 1.2rem;
      cursor: pointer;
    }
    .modal-body {
      font-size: 0.9rem;
      color: #4b5563;
      margin-bottom: 12px;
    }
    .timer-buttons {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      margin-bottom: 12px;
    }
    .timer-btn {
      border-radius: 999px;
      padding: 6px 10px;
      font-size: 0.85rem;
      border: 1px solid #e5e7eb;
      background: #f9fafb;
      cursor: pointer;
    }
    .timer-btn.active {
      background: #3b82f6;
      border-color: #2563eb;
      color: #ffffff;
    }
    .modal-footer {
      display: flex;
      justify-content: flex-end;
      gap: 8px;
      margin-top: 4px;
    }
    .modal-footer button {
      padding: 8px 14px;
      font-size: 0.9rem;
    }
    .hidden {
      display: none;
    }

    @media (max-width: 1200px) {
      .category-list {
        grid-template-columns: repeat(4, 1fr);
      }
    }
    @media (max-width: 900px) {
      .category-list {
        grid-template-columns: repeat(3, 1fr);
      }
    }
    @media (min-width: 768px) {
      #game-word {font-size: 15rem;} /* ë˜ëŠ” 14rem, 15rem ì›í•˜ëŠ”ëŒ€ë¡œ */
      .result-number{font-size: 20rem;}
    }
    @media (max-width: 600px) {
      .category-list {
        grid-template-columns: repeat(2, 1fr);
      }
    }

  </style>
</head>
<body>
  <div class="app">
    <!-- í—¤ë”ëŠ” ì²˜ìŒ í™”ë©´ì—ì„œë§Œ ë³´ì´ëŠ” ì˜ì—­ -->
    <div class="app-header" id="title-area">
      <h1>ëª¸ìœ¼ë¡œ ë§í•´ìš” ì œì‹œì–´ ê²Œì„</h1>
      <button class="icon-button" id="btn-settings">âš™ï¸</button>
    </div>
    <div class="subtitle" id="subtitle-area">
      ìš°ì¸¡ ìƒë‹¨ âš™ï¸ ë²„íŠ¼ìœ¼ë¡œ ë¼ìš´ë“œ ì‹œê°„ì„ ì„¤ì •í•˜ê³ ,<br>
      ì œì‹œì–´ë¥¼ ê³¨ë¼ O / X / íŒ¨ìŠ¤ë¡œ ì§„í–‰í•´ë´!
    </div>

    <!-- ì‚¬ìš´ë“œ -->
    <audio id="bg-sound" src="sounds/tick-loop.mp3" preload="auto" loop></audio>
    <audio id="end-sound" src="sounds/time-up.mp3" preload="auto"></audio>
    <audio id="sound-correct" src="sounds/correct.mp3" preload="auto"></audio>
    <audio id="sound-wrong"   src="sounds/wrong.mp3" preload="auto"></audio>
    <audio id="sound-pass"    src="sounds/pass.mp3" preload="auto"></audio>

    <!-- 1. ì œì‹œì–´ ì„ íƒ -->
    <div id="screen-list" class="screen active">
      <div class="category-list" id="category-list"></div>
    </div>

    <!-- 2. ì¤€ë¹„ -->
    <div id="screen-ready" class="screen">
      <div class="big-word" id="ready-category"></div>
      <div class="info-text">
        ì„ íƒí•œ ì œì‹œì–´ ì¹´í…Œê³ ë¦¬ë¡œ ê²Œì„ì„ ì‹œì‘í•´!<br>
        ì œí•œ ì‹œê°„ ì•ˆì— ë§ì¶¤ / í‹€ë¦¼ / íŒ¨ìŠ¤ë¡œ ì§„í–‰í•˜ë©´ ë¼.<br>
        (íŒ¨ìŠ¤ëŠ” í•œ íŒì— 2ë²ˆê¹Œì§€)
      </div>
      <div class="btn-row">
        <button class="btn-secondary" id="btn-back-list">ì œì‹œì–´ ë‹¤ì‹œ ê³ ë¥´ê¸°</button>
        <button class="btn-primary" id="btn-start-game">ê²Œì„ ì‹œì‘</button>
      </div>
    </div>

    <!-- 3. ê²Œì„ -->
    <div id="screen-game" class="screen">
      <div class="game-inner">
        <div class="game-header">
          <div class="badge timer">ë‚¨ì€ ì‹œê°„: <span id="time-text">0:00</span></div>
          <div class="badge score">ë§ì¶˜ ê°œìˆ˜: <span id="score-text">0</span></div>
        </div>
        <div class="game-word-wrap">
          <div id="game-word"></div>
        </div>
        <div>
          <div class="ox-row">
            <button class="btn-o" id="btn-o">ì •ë‹µ! (O)</button>
            <button class="btn-x" id="btn-x">í‹€ë¦¼ (X)</button>
          </div>
          <button class="btn-pass" id="btn-pass">íŒ¨ìŠ¤ (2íšŒ ë‚¨ìŒ)</button>
          <div class="btn-row">
            <button class="btn-ghost" id="btn-stop">ê²Œì„ ì¤‘ë‹¨</button>
          </div>
        </div>
      </div>
    </div>

    <!-- 4. ê²°ê³¼ -->
    <div id="screen-result" class="screen">
      <div class="result-label">ì´ë²ˆ ë¼ìš´ë“œì—ì„œ ë§íŒ ë¬¸ì œ ìˆ˜</div>
      <div class="result-number" id="result-score">0</div>
      <div class="info-text">
        ë‹¤ì‹œ í•˜ë ¤ë©´ ì•„ë˜ ë²„íŠ¼ì„ ëˆŒëŸ¬ ì œì‹œì–´ë¥¼ ê³ ë¥¸ ë’¤ ì‹œì‘í•´ì¤˜!
      </div>
      <div class="btn-row">
        <button class="btn-secondary" id="btn-result-to-list">ì œì‹œì–´ ëª©ë¡ìœ¼ë¡œ</button>
      </div>
    </div>
  </div>

  <!-- ì„¤ì • ëª¨ë‹¬ -->
  <div id="settings-backdrop" class="modal-backdrop hidden">
    <div class="modal">
      <div class="modal-header">
        <div class="modal-title">ë¼ìš´ë“œ ì‹œê°„ ì„¤ì •</div>
        <button class="modal-close" id="btn-settings-close">âœ•</button>
      </div>
      <div class="modal-body">30ì´ˆ ~ 180ì´ˆ ì¤‘ í•˜ë‚˜ë¥¼ ì„ íƒí•´ì¤˜.</div>
      <div class="timer-buttons">
        <button class="timer-btn" data-seconds="30">30ì´ˆ</button>
        <button class="timer-btn" data-seconds="60">60ì´ˆ</button>
        <button class="timer-btn" data-seconds="90">90ì´ˆ</button>
        <button class="timer-btn" data-seconds="120">120ì´ˆ</button>
        <button class="timer-btn" data-seconds="180">180ì´ˆ</button>
      </div>
      <div class="modal-footer">
        <button class="btn-secondary" id="btn-settings-ok">ë‹«ê¸°</button>
      </div>
    </div>
  </div>

  <script>
    /* ---- ë°ì´í„° ---- */
    const data = {
      "ğŸ¾ ë™ë¬¼": ["í­ê·„","ì½”ë¼ë¦¬","ê¸°ë¦°","ê³ ë˜","ìº¥ê±°ë£¨","ëŠ‘ëŒ€","í•˜ë§ˆ","ì—¬ìš°","íŒë‹¤","ë…ìˆ˜ë¦¬","ì½”ì•Œë¼","ë‹¤ëŒì¥","ë¶€ì—‰ì´","ìˆ˜ë‹¬","ë°”ë‹¤ê±°ë¶","ê³ ë¦´ë¼","ë‘ë”ì§€","ì›ìˆ­ì´","ë°”ë‹¤ì‚¬ì","ì‚¬ìŠ´","ìŠ¤ì»¹í¬","íƒ€ì¡°","ì¹˜íƒ€","ë¬¼ê°œ","ë‘ë£¨ë¯¸","ë°±ì¡°","ë°”ë‹¤í‘œë²”","ê±°ë¯¸","ë¬¸ì–´","ë§¤ë¯¸"],
      "ğŸ‰ ê³¼ì¼": ["ë°”ë‚˜ë‚˜","ìˆ˜ë°•","ì‚¬ê³¼","í¬ë„","íŒŒì¸ì• í”Œ","ì˜¤ë Œì§€","ì²´ë¦¬","ë§ê³ ","ìë‘","ë ˆëª¬","ê·¤","ë°°","ë³µìˆ­ì•„","ë¸”ë£¨ë² ë¦¬","ë©œë¡ ","ì„ë¥˜","ìëª½","ë¬´í™”ê³¼","ì•„ë³´ì¹´ë„","í‚¤ìœ„","ì½”ì½”ë„›","ë¼ì„","ì˜¬ë¦¬ë¸Œ","ëŒ€ì¶”ì•¼ì","ìš©ê³¼","íŒŒíŒŒì•¼","ì‚¬ê³¼ ë°˜ìª½","ê³¼ì¼ê¼¬ì¹˜","ê³¼ì¼ ì£¼ìŠ¤","ê³¼ì¼ ë°”êµ¬ë‹ˆ"],
      "ğŸ… ìŠ¤í¬ì¸ ": ["ë³¼ë§","ìˆ˜ì˜","ë†êµ¬","í…Œë‹ˆìŠ¤","ë°°ë“œë¯¼í„´","ì¶•êµ¬","ê³¨í”„","íƒœê¶Œë„","ìœ ë„","íœì‹±","ë³µì‹±","ìŠ¤í‚¤","ìŠ¤ë…¸ë³´ë“œ","ì„œí•‘","ì»¬ë§","íƒêµ¬","ìŠ¹ë§ˆ","ì–‘ê¶","ë§ˆë¼í†¤","ì—­ë„","ë¼í¬ë¡œìŠ¤","ì•„ì´ìŠ¤í•˜í‚¤","ìŠ¤ì¿¼ì‹œ","í´ë¼ì´ë°","ì²´ì¡°","ë°°êµ¬","ì”¨ë¦„","ì”¨í´ë¡œí¬ë¡œìŠ¤","ìˆ˜ìƒìŠ¤í‚¤","ì•”ë²½ë“±ë°˜"],
      "ğŸ’¼ ì§ì—…": ["ìš”ë¦¬ì‚¬","ê²½ì°°","ì†Œë°©ê´€","ì„ ìƒë‹˜","ì˜ì‚¬","ê°„í˜¸ì‚¬","ìš°ì²´ë¶€","íŒŒì¼ëŸ¿","ì¹´ë ˆì´ì„œ","ë°”ë¦¬ìŠ¤íƒ€","ì‚¬ì§„ì‘ê°€","ê°€ìˆ˜","ëŒ„ì„œ","ë§ˆìˆ ì‚¬","ìš´ë™ì„ ìˆ˜","í™”ê°€","DJ","í—¤ì–´ë””ìì´ë„ˆ","ì˜ì–‘ì‚¬","íŒì‚¬","ì •ë¹„ì‚¬","ë†ë¶€","íƒì‹œê¸°ì‚¬","ì„ ì›","ìˆ˜ì˜ì‚¬","ì‹¬íŒ","ì™¸êµê´€","ê³ ê³ í•™ì","ë“±ë°˜ê°€","ì„±ì•…ê°€"],
      "ğŸ” ìŒì‹": ["í”¼ì","í–„ë²„ê±°","ê¹€ë°¥","ë¼ë©´","ë–¡ë³¶ì´","ì¹˜í‚¨","ë§Œë‘","íŒŒìŠ¤íƒ€","ì¼€ì´í¬","ìƒŒë“œìœ„ì¹˜","ìŠ¤í…Œì´í¬","ì»¤ë¦¬","í–„&ì¹˜ì¦ˆ í† ìŠ¤íŠ¸","ìŒ€êµ­ìˆ˜","ì†Œê³ ê¸°êµ¬ì´","í”¼ì‰¬ì•¤ì¹©ìŠ¤","í•«ë„ê·¸","ì‚¼ê²¹ì‚´","íƒ•ìˆ˜ìœ¡","ìš°ë™","ì´ˆë°¥","ì˜¤ë¯€ë¼ì´ìŠ¤","ë¶€ë¦¬ë˜","íƒ€ì½”","ì¹˜ì¦ˆíë“€","ë¡œë¸ŒìŠ¤í„°","íŒŒì—ì•¼","ê·¸ë¦´ ì±„ì†Œ","íŒì½˜","ë°”ë¹„í"],
      "ğŸ˜Š ê°ì •": ["ê¸°ì¨","ìŠ¬í””","ë¶„ë…¸","ë‹¹í™©","ë†€ëŒ","ì§€ë£¨í•¨","ìë‘ìŠ¤ëŸ¬ì›€","ë¿Œë“¯í•¨","ì• ì •","ë¯¼ë§í•¨","í”¼ê³¤í•¨","í™œê¸°ì°¸","ì´ˆì¡°í•¨","ê¹œì§ í–‰ë³µ","ì‹¬ìˆ ","ì‘ì›í•˜ëŠ” ê¸°ë¶„","í™”í•´í•˜ë ¤ëŠ” ê°ì •","ê¸´ì¥","ìŠ¹ë¦¬ê°","ì•„ì‰¬ì›€","í›„íšŒ","ì§ˆíˆ¬","í—ˆì„¸","ì—´ê´‘","ëƒ‰ë‹´í•¨","ì§‘ì°©","ê²½ìŸì‹¬","íë­‡í•¨","ìí¬ìê¸°","í¸ì•ˆí•¨"],
      "ğŸ“¦ ì‚¬ë¬¼": ["ì¹´ë©”ë¼","ì‹œê³„","ì¹¼","ìš°ì‚°","ë¹—ìë£¨","ì„ í’ê¸°","ì¹«ì†”","ì´ì–´í°","ê°€ìœ„","ë§ì¹˜","ë‚šì‹¯ëŒ€","ë¼ì´í„°","í…íŠ¸","ë‹ë³´ê¸°","ì „ê¸°ë°¥ì†¥","í‚¤ë³´ë“œ","ë§ˆìš°ìŠ¤","ì˜ì","ì§€ê°‘","ì„ ê¸€ë¼ìŠ¤","ìºë¦¬ì–´","ë“œë¡ ","ë—ìë¦¬","ë¶•ëŒ€","í™”ì¥í’ˆ íŒŒìš°ì¹˜","ë¹„ëˆ„","ìŠ¤ë§ˆíŠ¸ì›Œì¹˜","ë¦¬ëª¨ì»¨","ì…€ì¹´ë´‰","ë§ì›ê²½"]
    };

    /* ---- DOM ---- */
    const screenList   = document.getElementById("screen-list");
    const screenReady  = document.getElementById("screen-ready");
    const screenGame   = document.getElementById("screen-game");
    const screenResult = document.getElementById("screen-result");
    const titleArea    = document.getElementById("title-area");
    const subtitleArea = document.getElementById("subtitle-area");

    const categoryListEl   = document.getElementById("category-list");
    const readyCategoryEl  = document.getElementById("ready-category");
    const gameWordEl       = document.getElementById("game-word");
    const timeTextEl       = document.getElementById("time-text");
    const scoreTextEl      = document.getElementById("score-text");
    const resultScoreEl    = document.getElementById("result-score");
    const btnBackList      = document.getElementById("btn-back-list");
    const btnStartGame     = document.getElementById("btn-start-game");
    const btnO             = document.getElementById("btn-o");
    const btnX             = document.getElementById("btn-x");
    const btnPass          = document.getElementById("btn-pass");
    const btnStop          = document.getElementById("btn-stop");
    const btnResultToList  = document.getElementById("btn-result-to-list");
    const btnSettings      = document.getElementById("btn-settings");
    const settingsBackdrop = document.getElementById("settings-backdrop");
    const btnSettingsClose = document.getElementById("btn-settings-close");
    const btnSettingsOk    = document.getElementById("btn-settings-ok");

    const timerButtons     = settingsBackdrop.querySelectorAll(".timer-btn");

    const bgSound      = document.getElementById("bg-sound");
    const endSound     = document.getElementById("end-sound");
    const soundCorrect = document.getElementById("sound-correct");
    const soundWrong   = document.getElementById("sound-wrong");
    const soundPass    = document.getElementById("sound-pass");

    /* ---- ìƒíƒœ ---- */
    let selectedTimeSec = 60;
    let currentCategory = null;
    let currentIndex = 0;
    let currentWords = [];
    let score = 0;
    let timeLeft = 60;
    let timerId = null;
    let passCount = 0;
    const maxPass = 2;

    /* ---- ê³µí†µ ---- */
    function shuffle(arr) {
      const a = arr.slice();
      for (let i=a.length-1; i>0; i--) {
        const j = Math.floor(Math.random()*(i+1));
        [a[i], a[j]] = [a[j], a[i]];
      }
      return a;
    }
    function formatTime(sec) {
      const m = Math.floor(sec/60);
      const s = sec%60;
      return m + ":" + (s<10 ? "0"+s : s);
    }

    /* ---- í™”ë©´ í‘œì‹œ ì œì–´ (íƒ€ì´í‹€/í†±ë‹ˆ í¬í•¨) ---- */
    function showScreen(target) {
      [screenList, screenReady, screenGame, screenResult].forEach(s => s.classList.remove("active"));
      target.classList.add("active");

      const isListScreen = (target === screenList);
      titleArea.style.display = isListScreen ? "flex" : "none";
      subtitleArea.style.display = isListScreen ? "block" : "none";
      btnSettings.style.display = isListScreen ? "block" : "none";
    }

    /* ---- ì„¤ì • ëª¨ë‹¬ ---- */
    function setSelectedTime(sec) {
      selectedTimeSec = sec;
      timerButtons.forEach(btn=>{
        btn.classList.toggle("active", Number(btn.dataset.seconds)===sec);
      });
    }
    btnSettings.addEventListener("click", ()=> {
      setSelectedTime(selectedTimeSec);
      settingsBackdrop.classList.remove("hidden");
    });
    btnSettingsClose.addEventListener("click", ()=> settingsBackdrop.classList.add("hidden"));
    btnSettingsOk.addEventListener("click", ()=> settingsBackdrop.classList.add("hidden"));
    timerButtons.forEach(btn=>{
      btn.addEventListener("click", ()=> setSelectedTime(Number(btn.dataset.seconds)));
    });
    settingsBackdrop.addEventListener("click", e=>{
      if(e.target===settingsBackdrop) settingsBackdrop.classList.add("hidden");
    });

    /* ---- íŒ¨ìŠ¤ ë²„íŠ¼ ì—…ë°ì´íŠ¸ ---- */
    function updatePassButton() {
      const r = maxPass - passCount;
      btnPass.textContent = `íŒ¨ìŠ¤ (${r}íšŒ ë‚¨ìŒ)`;
      btnPass.disabled = r<=0;
    }

    /* ---- ì‚¬ìš´ë“œ ---- */
    function playCorrectSound(){ try{soungCorrect.currentTime=0; soundCorrect.play();}catch{} }
    function playWrongSound(){   try{soundWrong.currentTime=0;   soundWrong.play();}catch{} }
    function playPassSound(){    try{soundPass.currentTime=0;    soundPass.play();}catch{} }

    /* ---- ê²Œì„ ë¡œì§ ---- */
    function openReadyScreen() {
      const parts = currentCategory.split(" ");
      readyCategoryEl.textContent = parts.length>1 ? parts.slice(1).join(" ") : currentCategory;
      showScreen(screenReady);
    }

    function startGame() {
      score = 0;
      timeLeft = selectedTimeSec;
      passCount = 0;

      scoreTextEl.textContent = score;
      timeTextEl.textContent = formatTime(timeLeft);
      updatePassButton();

      currentWords = shuffle(data[currentCategory]);
      currentIndex = 0;
      gameWordEl.textContent = currentWords[currentIndex];

      if(timerId) clearInterval(timerId);
      timerId = setInterval(()=>{
        timeLeft--;
        if(timeLeft<=0) {
          timeLeft = 0;
          timeTextEl.textContent = formatTime(timeLeft);
          endGame(true);
        } else {
          timeTextEl.textContent = formatTime(timeLeft);
        }
      },1000);

      try{bgSound.currentTime=0; bgSound.play();}catch{}
      showScreen(screenGame);
    }

    function goNextWord() {
      currentIndex = (currentIndex + 1) % currentWords.length;
      gameWordEl.textContent = currentWords[currentIndex];
    }

    function endGame() {
      if(timerId) { clearInterval(timerId); timerId=null; }
      try{ bgSound.pause(); bgSound.currentTime=0; }catch{}
      try{ endSound.currentTime=0; endSound.play(); }catch{}
      resultScoreEl.textContent = score;
      showScreen(screenResult);
    }

    /* ---- ë²„íŠ¼ ì´ë²¤íŠ¸ ---- */
    btnStartGame.addEventListener("click", () => {
      // ğŸ”Š ì¢…ë£Œ íš¨ê³¼ìŒ ì‚¬ìš´ë“œ ê¶Œí•œ ë¯¸ë¦¬ í™•ë³´
      endSound.play().then(() => {
        endSound.pause();
        endSound.currentTime = 0;
      }).catch(() => {});

      // ğŸ–¥ ì „ì²´í™”ë©´ ìš”ì²­ (ê°¤ëŸ­ì‹œ íƒ­ í¬ë¡¬ í¬í•¨)
      const docEl = document.documentElement;
      if (docEl.requestFullscreen) {
        docEl.requestFullscreen().catch(() => {});
      } else if (docEl.webkitRequestFullscreen) { // í˜¹ì‹œ êµ¬í˜• ë¸Œë¼ìš°ì € ëŒ€ë¹„
        docEl.webkitRequestFullscreen();
      }

      // ğŸ® ê²Œì„ ì‹œì‘
      startGame();
    });

    btnBackList.addEventListener("click", ()=> showScreen(screenList));
    btnResultToList.addEventListener("click", ()=> showScreen(screenList));
    btnStop.addEventListener("click", ()=> endGame());

    btnO.addEventListener("click", ()=>{
      score++; scoreTextEl.textContent=score;
      try{ soundCorrect.currentTime=0; soundCorrect.play(); }catch{}
      goNextWord();
    });
    btnX.addEventListener("click", ()=>{
      try{ soundWrong.currentTime=0; soundWrong.play(); }catch{}
      goNextWord();
    });
    btnPass.addEventListener("click", ()=>{
      if(passCount>=maxPass) return;
      passCount++;
      updatePassButton();
      try{ soundPass.currentTime=0; soundPass.play(); }catch{}
      goNextWord();
    });

    /* ---- ì¹´í…Œê³ ë¦¬ ë Œë”ë§ ---- */
    function renderCategoryList() {
      categoryListEl.innerHTML = "";
      Object.keys(data).forEach(name=>{
        const count = data[name].length;
        const parts = name.split(" ");
        const emoji = parts[0];
        const label = parts.slice(1).join(" ");
        const btn = document.createElement("button");
        btn.className = "category-item";
        btn.innerHTML = `
          <div style="display:flex;flex-direction:column;align-items:center;">
            <span style="margin-bottom:5px;font-size:3rem;line-height:1;">${emoji}</span>
            <span>${label}</span>
          </div>
          <span class="sub">${count} ë¬¸ì œ</span>
        `;
        btn.addEventListener("click", ()=>{
          currentCategory = name;
          openReadyScreen();
        });
        categoryListEl.appendChild(btn);
      });
    }

    /* ---- ì´ˆê¸° ë Œë” ---- */
    renderCategoryList();
  </script>
</body>
</html>
